<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>LineShelf AIæ›¸å¿«æ‹ - æˆ‘çš„æ›¸ç±</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <link rel="stylesheet" href="../static/css/style.css"/>
    <style>
        /* åŠé€æ˜èƒŒæ™¯é®ç½© */
        #modalOverlay, #editModalOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        /* è¡¨å–®å®¹å™¨æ¨£å¼ */
        #addBookForm, #editBookForm {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            position: relative;
            max-height: 85vh;
            overflow-y: auto;
        }

        #addBookForm h3, #editBookForm h3 {
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
        }

        #addBookForm label, #editBookForm label {
            display: block;
            margin-bottom: 10px;
        }

        #addBookForm input[type="text"],
        #addBookForm input[type="number"],
        #editBookForm input[type="text"],
        #editBookForm input[type="number"],
        #addBookForm input[type="file"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #addBookForm input[type="file"] {
            border: none;
            padding-left: 0;
        }

        /* é—œé–‰æŒ‰éˆ• */
        #closeModal, #closeEditModal {
            position: absolute;
            top: 10px;
            right: 12px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #aaa;
            padding: 5px;
            line-height: 1;
            transition: color 0.2s;
        }

        #closeModal:hover, #closeEditModal:hover {
            color: #333;
        }

        /* ä¸Šå‚³æŒ‰éˆ• */
        #uploadBtn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            background-color: #00B900;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #uploadBtn:hover {
            background-color: #009900;
        }

        /* å„²å­˜æŒ‰éˆ• */
        #saveEditBtn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #saveEditBtn:hover {
            background-color: #0056b3;
        }

        /* æ›¸æ³å‹¾é¸å€å¡Šæ¨£å¼ */
        .condition-checkbox-group {
            text-align: left;
            margin-bottom: 15px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        .condition-checkbox-label {
            display: inline-flex;
            align-items: center;
            margin-right: 15px;
            cursor: pointer;
            font-size: 0.95rem;
            color: #555;
        }

        .condition-checkbox-label input {
            accent-color: #00B900; /* å‹¾é¸æ™‚è®Šæˆ LINE ç¶ è‰² */
            width: 16px !important;
            height: 16px;
        }

        /* ğŸ”½ğŸ”½ğŸ”½ [ ğŸŸ¢ æ–°å¢ CSSï¼šåˆ—è¡¨ä¸­çš„ç·¨è¼¯èˆ‡åˆªé™¤æŒ‰éˆ• ] ğŸ”½ğŸ”½ğŸ”½ */

        /* å…±ç”¨æŒ‰éˆ•æ¨£å¼ */
        .edit-btn, .delete-btn {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            color: white;
            font-weight: 500;
            transition: all 0.2s ease; /* å¹³æ»‘éæ¸¡æ•ˆæœ */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* ç·¨è¼¯æŒ‰éˆ• - è—è‰²ç³» */
        .edit-btn {
            background-color: #4a90e2;
            margin-right: 8px; /* èˆ‡åˆªé™¤æŒ‰éˆ•çš„é–“è· */
        }

        .edit-btn:hover {
            background-color: #357abd;
            transform: translateY(-2px); /* æ»‘é¼ ç§»ä¸Šå»å¾®å¾®ä¸Šæµ® */
            box-shadow: 0 4px 8px rgba(74, 144, 226, 0.3);
        }

        /* åˆªé™¤æŒ‰éˆ• - ç´…è‰²ç³» */
        .delete-btn {
            background-color: #ff5b5b;
        }

        .delete-btn:hover {
            background-color: #e04f4f;
            transform: translateY(-2px); /* æ»‘é¼ ç§»ä¸Šå»å¾®å¾®ä¸Šæµ® */
            box-shadow: 0 4px 8px rgba(255, 91, 91, 0.3);
        }

        /* ğŸ”¼ğŸ”¼ğŸ”¼ [ ğŸŸ¢ æ–°å¢å®Œç•¢ ] ğŸ”¼ğŸ”¼ğŸ”¼ */

    </style>
</head>
<body id="page-mybooks">
<header class="nav">
    <div class="nav-container">
        <div class="brand">
            <img src="logo.png" alt="ç¶²ç«™Logo" class="brand-logo"/>
            <span class="brand-name">LineShelf AIæ›¸å¿«æ‹</span>
        </div>
        <nav class="nav-links">
            <a href="/">é¦–é </a>
            <a href="/book">æˆ‘çš„æ›¸ç±</a>
            <a href="/cart">è³¼ç‰©è»Š</a>
        </nav>
    </div>
    <div class="nav-right">
        <div class="nav-user">
            <img id="user-picture" src="" alt="User Picture"> <span id="user-name"></span>
            <span id="user-id" style="display:none;"></span>
        </div>
        <button onclick="liff.logout()">ç™»å‡º</button>
    </div>
</header>

<main class="container">
    <br><br><br>
    <h2>æˆ‘çš„æ›¸ç±</h2>
    <div class="actions">
        <button id="btnAdd">ä¸Šæ¶æ›¸ç±</button>
        <button id="btnManage">ç®¡ç†æ›¸ç±</button>
        <button onclick="window.location='/'">è¿”å›é¦–é </button>
    </div>

    <!-- ä¸Šæ¶ Modal -->
    <div id="modalOverlay">
        <div id="addBookForm">
            <button id="closeModal">&times;</button>
            <h3>ä¸Šæ¶æ–°æ›¸</h3>
            <input type="text" id="bookTitle" placeholder="æ›¸å"/><br/>
            <input type="text" id="bookAuthor" placeholder="ä½œè€…"/><br/>
            <input type="number" id="bookPrice" placeholder="åƒ¹æ ¼"/><br/>

            <div class="condition-checkbox-group">
                <p style="margin: 0 0 8px 0; font-weight: bold; font-size: 0.9rem; color: #555;">æ›¸æ³ç´°ç¯€ï¼š</p>
                <label class="condition-checkbox-label">
                    <input type="checkbox" id="bookHasHighlight">
                    æœ‰è¢å…‰/åŠƒç·š
                </label>
                <label class="condition-checkbox-label">
                    <input type="checkbox" id="bookHasNote">
                    æœ‰æ›¸å¯«ç­†è¨˜
                </label>
            </div>

            <label>å°é¢(front)ï¼š<input type="file" id="bookFrontInput" accept="image/*"/></label>
            <label>æ›¸èƒŒ(spine)ï¼š<input type="file" id="bookSpineInput" accept="image/*"/></label>
            <label>å°åº•(back)ï¼š<input type="file" id="bookBackInput" accept="image/*"/></label>

            <p>AIæ›¸æ³é æ¸¬: <span id="bookCondition">å°šæœªé æ¸¬</span></p>
            <div id="result"></div>

            <button id="uploadBtn">ä¸Šå‚³æ›¸ç±</button>
        </div>
    </div>

    <!-- ç·¨è¼¯ Modal -->
    <div id="editModalOverlay">
        <div id="editBookForm">
            <button id="closeEditModal">&times;</button>
            <h3>ç·¨è¼¯æ›¸ç±è³‡æ–™</h3>
            <input type="hidden" id="editBookId"/>

            <label>æ›¸åï¼š</label>
            <input type="text" id="editBookTitle"/><br/>

            <label>ä½œè€…ï¼š</label>
            <input type="text" id="editBookAuthor"/><br/>

            <label>åƒ¹æ ¼ï¼š</label>
            <input type="number" id="editBookPrice"/><br/>

            <div class="condition-checkbox-group">
                <p style="margin: 0 0 8px 0; font-weight: bold; font-size: 0.9rem; color: #555;">æ›¸æ³ç´°ç¯€ï¼š</p>
                <label class="condition-checkbox-label">
                    <input type="checkbox" id="editBookHasHighlight">
                    æœ‰è¢å…‰/åŠƒç·š
                </label>
                <label class="condition-checkbox-label">
                    <input type="checkbox" id="editBookHasNote">
                    æœ‰æ›¸å¯«ç­†è¨˜
                </label>
            </div>

            <button id="saveEditBtn">å„²å­˜è®Šæ›´</button>
        </div>
    </div>
    <section class="book-list" id="myBooksList"></section>
</main>

<script type="module" src="../static/js/book.js"></script>
<script>
    // Modal æ§åˆ¶é‚è¼¯
    const btnAdd = document.getElementById('btnAdd');
    const modal = document.getElementById('modalOverlay');
    const closeModal = document.getElementById('closeModal');

    if (btnAdd && modal) {
        btnAdd.addEventListener('click', () => {
            modal.style.display = 'flex';
        });
    }

    if (closeModal && modal) {
        closeModal.addEventListener('click', () => {
            modal.style.display = 'none';
        });
    }

    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) modal.style.display = 'none';
        });
    }

    const editModal = document.getElementById('editModalOverlay');
    const closeEditModal = document.getElementById('closeEditModal');

    if (closeEditModal && editModal) {
        closeEditModal.addEventListener('click', () => {
            editModal.style.display = 'none';
        });
        editModal.addEventListener('click', (e) => {
            if (e.target === editModal) editModal.style.display = 'none';
        });
    }
</script>
</body>
</html>